import{c as P,u as A,r as l,a as y,d as C,j as e,e as t,A as v,y as g}from"./index-BJNj8_gr.js";import{M as W,g as Q,h as F,i as O,j as z,d as $,k as G}from"./index-DLTgG_l3.js";import{R as K}from"./index-BMSfizGN.js";import{B as j}from"./BuyerBottomNav-CEiaXiD3.js";import{T as V}from"./TopTabBar-D0O44pMI.js";/* empty css                       */const ee=()=>{const{buyerToken:x}=P(),m=A(),[k,f]=l.useState(!0),[q,S]=l.useState([]),[o,N]=l.useState(null),[r,u]=l.useState(0),[U,h]=l.useState(!1),[b,B]=l.useState(null),[a,d]=l.useState({color:"",location:"",height:"",width:"",quantity:"",remarks:""});l.useEffect(()=>{D()},[]);const D=async()=>{try{f(!0);const i=(await y.get(C("api/options"))).data.map(n=>({id:n._id,name:n.title.toUpperCase(),count:n.subOptions.length,designs:n.subOptions.map(c=>({id:c._id,title:c.title,video:c.videoUrl,features:c.features||[]}))}));S(i)}catch(s){B(s.message),console.error("Error fetching window designs:",s)}finally{f(!1)}},E=()=>{m("/buyer/notifications")},I=s=>{o&&o.id===s.id?(N(null),u(0)):(N(s),u(0))},M=()=>{o&&r<o.designs.length-1&&u(r+1)},L=()=>{r>0&&u(r-1)},R=()=>{if(!x){alert("Please login to add quotes"),m("/buyer/login");return}if(!o){alert("Please select a window design first");return}h(!0)},T=async()=>{if(!a.color||!a.location||!a.height||!a.width||!a.quantity){g.error("Please fill in all required fields");return}try{const s=o.designs[r],i=await y.post(C("api/quotes"),{productType:o.name,product:s.id,color:a.color,installationLocation:a.location,height:parseFloat(a.height),width:parseFloat(a.width),quantity:parseInt(a.quantity),remark:a.remarks||""},{headers:{Authorization:`Bearer ${x}`}});i.data.success?(g.success("Quote added successfully!"),h(!1),d({color:"",location:"",height:"",width:"",quantity:"",remarks:""})):g.error(i.data.message||"Failed to add quote")}catch(s){console.error("Error adding quote:",s);const i=s.response?.data?.message||s.message||"Failed to add quote. Please try again.";g.error(i)}},p=s=>{if(!s)return console.warn("resolveMediaUrl: No URL provided"),null;const i=String(s).trim().replace(/\\/g,"/");if(console.log("resolveMediaUrl - Input:",s),console.log("resolveMediaUrl - Cleaned:",i),/^https?:\/\//i.test(i))return console.log("resolveMediaUrl - Already full URL:",i),i;const n=i.startsWith("/")?i.substring(1):i;if(console.log("resolveMediaUrl - Without leading slash:",n),n.startsWith("uploads/")){const w=`${v}/${n}`;return console.log("resolveMediaUrl - Path has uploads/, Final URL:",w),w}const c=`${v}/uploads/${n}`;return console.log("resolveMediaUrl - Added uploads/ prefix, Final URL:",c),c};return k?e.jsxs("div",{className:"buyer-dashboard-container",children:[e.jsx("div",{className:"loading-container",children:e.jsx("div",{className:"spinner"})}),e.jsx(j,{})]}):b?e.jsxs("div",{className:"buyer-dashboard-container",children:[e.jsx("div",{className:"error-container",children:e.jsxs(t,{className:"error-text",children:["Error: ",b]})}),e.jsx(j,{})]}):e.jsxs("div",{className:"buyer-dashboard-container",children:[e.jsxs("div",{className:"buyer-dashboard-header",children:[e.jsx("div",{className:"header-spacer"}),e.jsx("img",{src:"/logo.png",alt:"Logo",className:"dashboard-logo"}),e.jsx("button",{className:"notification-button",onClick:E,"aria-label":"Notifications",children:e.jsx(W,{size:24,color:"#000"})})]}),e.jsx(V,{}),e.jsxs("div",{className:"buyer-dashboard-content buy-now-content",children:[e.jsxs("div",{className:"buy-now-header",children:[e.jsx("div",{className:"buy-now-icon-wrapper",children:e.jsx(Q,{className:"buy-now-icon"})}),e.jsx(t,{weight:"Inter",className:"buy-now-title",children:"SELECT WINDOW DESIGN"}),e.jsx("div",{className:"buy-now-divider"}),e.jsx(t,{weight:"Inter",className:"buy-now-subtitle",children:"Choose from our premium window designs and request a quote"})]}),e.jsx("div",{className:"window-designs-list",children:q.map(s=>e.jsxs("div",{className:"design-category",children:[e.jsxs("button",{className:`category-header ${o?.id===s.id?"active":""}`,onClick:()=>I(s),children:[e.jsx("div",{className:"category-icon-wrapper",children:e.jsx(F,{className:"category-icon"})}),e.jsxs("div",{className:"category-info",children:[e.jsx(t,{weight:"Inter",className:"category-name",children:s.name}),e.jsx("div",{className:"category-count-wrapper",children:e.jsxs(t,{weight:"Inter",className:"category-count",children:[s.count," ",s.count===1?"Design":"Designs"]})})]}),e.jsx("div",{className:"expand-icon-wrapper",children:e.jsx("span",{className:"expand-icon",children:o?.id===s.id?"âˆ’":"+"})})]}),o?.id===s.id&&e.jsxs("div",{className:"designs-container",children:[e.jsxs("div",{className:"design-navigation",children:[e.jsx("button",{className:"nav-button",onClick:L,disabled:r===0,children:e.jsx(O,{size:24})}),e.jsxs(t,{weight:"Inter",className:"design-counter",children:[r+1," / ",o.designs.length]}),e.jsx("button",{className:"nav-button",onClick:M,disabled:r===o.designs.length-1,children:e.jsx(z,{size:24})})]}),o.designs[r]&&e.jsxs("div",{className:"design-card",children:[e.jsxs("div",{className:"design-title-wrapper",children:[e.jsx("div",{className:"design-title-decoration"}),e.jsx(t,{weight:"Inter",className:"design-title",children:o.designs[r].title}),e.jsx("div",{className:"design-title-decoration"})]}),o.designs[r].video&&e.jsx("div",{className:"design-video-container",children:e.jsx(K,{url:p(o.designs[r].video),controls:!0,playing:!1,width:"100%",height:"100%",onError:i=>{const n=p(o.designs[r].video);console.error(`
âŒ === BuyNowPage Video Load Error ===`),console.error("Design Title:",o.designs[r].title),console.error("Design Index:",r),console.error("Category:",o.name),console.error("Original Video Path:",o.designs[r].video),console.error("Resolved URL:",n),console.error("API Base URL:",v),console.error("Error Event:",i),console.error("Error Type:",i?.type),console.error("Error Target:",i?.target),console.error(`
ðŸ’¡ Troubleshooting:`),console.error("1. Check if file exists at:",n),console.error("2. Verify file permissions on server"),console.error("3. Check server CORS settings for video files"),console.error("4. Test URL directly in browser:",n),console.error(`========================================
`)},onReady:()=>{console.log("âœ… BuyNowPage video ready:",{title:o.designs[r].title,originalPath:o.designs[r].video,resolvedUrl:p(o.designs[r].video)})},config:{file:{attributes:{controlsList:"nodownload",preload:"metadata"}}}})}),o.designs[r].features?.length>0&&e.jsxs("div",{className:"design-features",children:[e.jsxs("div",{className:"features-header",children:[e.jsx(t,{weight:"Inter",className:"features-title",children:"Key Features"}),e.jsx("div",{className:"features-badge",children:o.designs[r].features.length})]}),e.jsx("div",{className:"features-grid",children:o.designs[r].features.map((i,n)=>e.jsxs("div",{className:"feature-item",children:[e.jsx("div",{className:"feature-icon-wrapper",children:e.jsx($,{className:"feature-icon"})}),e.jsx(t,{weight:"Inter",className:"feature-text",children:i})]},n))})]}),e.jsx("button",{className:"add-quote-button",onClick:R,children:e.jsx(t,{weight:"Inter",className:"add-quote-text",children:"ADD TO QUOTE"})})]})]})]},s.id))})]}),U&&e.jsx("div",{className:"quote-modal-overlay",onClick:()=>h(!1),children:e.jsxs("div",{className:"quote-modal",onClick:s=>s.stopPropagation(),children:[e.jsxs("div",{className:"quote-modal-header",children:[e.jsx(t,{weight:"Inter",className:"quote-modal-title",children:"Request Quote"}),e.jsx("button",{className:"close-button",onClick:()=>h(!1),children:"Ã—"})]}),e.jsxs("div",{className:"quote-form",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Color *"}),e.jsxs("select",{value:a.color,onChange:s=>d({...a,color:s.target.value}),children:[e.jsx("option",{value:"",children:"Select Color"}),e.jsx("option",{value:"White",children:"White"}),e.jsx("option",{value:"Black",children:"Black"}),e.jsx("option",{value:"Wooden Brown",children:"Wooden Brown"}),e.jsx("option",{value:"Silver Grey",children:"Silver Grey"}),e.jsx("option",{value:"Golden Oak",children:"Golden Oak"})]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Location *"}),e.jsxs("select",{value:a.location,onChange:s=>d({...a,location:s.target.value}),children:[e.jsx("option",{value:"",children:"Select Location"}),e.jsx("option",{value:"Balcony",children:"Balcony"}),e.jsx("option",{value:"Living Room",children:"Living Room"}),e.jsx("option",{value:"Bedroom",children:"Bedroom"}),e.jsx("option",{value:"Kitchen",children:"Kitchen"}),e.jsx("option",{value:"Bathroom",children:"Bathroom"})]})]}),e.jsxs("div",{className:"form-row",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Height (ft) *"}),e.jsx("input",{type:"number",value:a.height,onChange:s=>d({...a,height:s.target.value}),placeholder:"e.g. 5"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Width (ft) *"}),e.jsx("input",{type:"number",value:a.width,onChange:s=>d({...a,width:s.target.value}),placeholder:"e.g. 4"})]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Quantity *"}),e.jsx("input",{type:"number",value:a.quantity,onChange:s=>d({...a,quantity:s.target.value}),placeholder:"e.g. 2"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Remarks"}),e.jsx("textarea",{value:a.remarks,onChange:s=>d({...a,remarks:s.target.value}),placeholder:"Any additional information...",rows:"3"})]}),e.jsx("button",{className:"submit-quote-button",onClick:T,children:e.jsx(t,{weight:"Inter",className:"submit-quote-text",children:"SUBMIT QUOTE"})})]})]})}),x&&e.jsx("div",{style:{position:"fixed",bottom:"100px",right:"20px",zIndex:1e3},children:e.jsxs("button",{onClick:()=>m("/buyer/quote-request"),style:{display:"flex",alignItems:"center",gap:"8px",padding:"14px 24px",backgroundColor:"#000",color:"#fff",border:"none",borderRadius:"50px",fontSize:"16px",fontWeight:"600",cursor:"pointer",boxShadow:"0 4px 12px rgba(0,0,0,0.3)",transition:"all 0.2s"},onMouseEnter:s=>s.target.style.backgroundColor="#333",onMouseLeave:s=>s.target.style.backgroundColor="#000",children:[e.jsx(G,{size:20}),e.jsx("span",{children:"Submit Quote Request"})]})}),e.jsx(j,{})]})};export{ee as default};
